{% extends "base.html" %}
{% load i18n %} <!-- Añadir para cargar internacionalización -->

{% block content %}
{% load static %}

<h2>{% trans "Products" %}</h2>
<!--
<form method="get">
    <select name="category" onchange="this.form.submit()">
        {% for cat in categories %}
        <option value="{{ cat.id }}" {% if cat.id == selected_category %}selected{% endif %}>
            {{ cat.name }}
        </option>
        {% endfor %}
    </select>
</form>
-->

<div class="row row-cols-md-2 row-cols-lg-4 g-4">
  {% for product in products %}
    {% include "products/_product_card.html" %}
  {% empty %}
    <div class="col">
      <div class="alert alert-warning text-center w-100">
        {% trans "No products found" %}
      </div>
    </div>
  {% endfor %}
</div>

{% if is_paginated %}
<nav aria-label="{% trans 'Page navigation' %}"> <!-- Etiqueta accesible para navegación -->
  <ul class="pagination justify-content-center mt-4">
    {% if page_obj.has_previous %}
    <li class="page-item">
      <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}" aria-label="{% trans 'Previous' %}">
        <span aria-hidden="true">«</span>
        <span class="visually-hidden">{% trans "Previous" %}</span> <!-- Para accesibilidad -->
      </a>
    </li>
    {% else %}
    <li class="page-item disabled"><span class="page-link">«</span></li>
    {% endif %}

    {% for num in page_obj.paginator.page_range %}
      {% if page_obj.number == num %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
      {% elif num > page_obj.number|add:"-3" and num < page_obj.number|add:"3" %}
        <li class="page-item">
          <a class="page-link" href="?page={{ num }}{% if selected_category %}&category={{ selected_category }}{% endif %}">{{ num }}</a>
        </li>
      {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
    <li class="page-item">
      <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}" aria-label="{% trans 'Next' %}">
        <span aria-hidden="true">»</span>
        <span class="visually-hidden">{% trans "Next" %}</span> <!-- Para accesibilidad -->
      </a>
    </li>
    {% else %}
    <li class="page-item disabled"><span class="page-link">»</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}

{% endblock %}